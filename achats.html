<script>

const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS80EbOdyJxdT8hmQAux0KJXM-LHsGKFP5eEGQuo28JFid6CwEVCApcOJ-0GpncdDul4Q97VvmjdmTm/pub?output=csv";

let table;

function toNumber(v){
 if(!v) return 0;
 return parseFloat(v.replace(",",".").replace(" ","")) || 0;
}

Papa.parse(csvUrl, {
 download: true,
 skipEmptyLines: true,

 complete: function(results){

   const rows = results.data;
   rows.shift(); // enlÃ¨ve header

   const fournisseurs = new Set();
   const refs = new Set();

   rows.forEach(r => {

     const date = r[0];
     const fournisseur = r[1];
     const type = r[3];
     const ref = r[5];
     const ht = r[4];

     fournisseurs.add(fournisseur);
     refs.add(ref);

     $("#table tbody").append(`
       <tr>
         <td>${date}</td>
         <td>${fournisseur}</td>
         <td>${type}</td>
